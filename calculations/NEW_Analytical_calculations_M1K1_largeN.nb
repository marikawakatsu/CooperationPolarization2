(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13735,        407]
NotebookOptionsPosition[     12300,        376]
NotebookOutlinePosition[     12692,        392]
CellTagsIndexPosition[     12649,        389]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Analytical calculations for M = 1 (large N limit) (take 2)", "Title",
 CellChangeTimes->{{3.823385330106954*^9, 3.8233853523630857`*^9}, {
  3.8234523651139727`*^9, 
  3.823452375389492*^9}},ExpressionUUID->"1a4704ba-5d29-4218-886c-\
1ac9dab42a90"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8233880918884287`*^9, 3.8233880919031973`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"50828f83-f146-4bc3-9348-2b5bd8c82238"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Pi]general", "[", 
   RowBox[{"i_", ",", "sia_", ",", "sid_"}], "]"}], ":=", " ", 
  RowBox[{"(*", 
   RowBox[{"sia", ",", 
    RowBox[{"sid", "\[Element]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], " ", "to", " ", "indicate", " ", 
      "strategy"}]}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"sia", "*", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"i", ",", "a"}], "}"}]]}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{"b", "-", "c"}], ")"}]}], " ", "+", " ", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"l", "=", "1"}], "n"], " ", 
     RowBox[{"ExpandAll", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "c"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sia", "*", 
             SubscriptBox["s", 
              RowBox[{"{", 
               RowBox[{"i", ",", "a"}], "}"}]]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{"sid", "*", 
             SubscriptBox["s", 
              RowBox[{"{", 
               RowBox[{"i", ",", "d"}], "}"}]]}], ")"}]}], ")"}]}], "+", 
        RowBox[{"b", "  ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["s", 
            RowBox[{"{", 
             RowBox[{"l", ",", "a"}], "}"}]], "+", 
           SubscriptBox["s", 
            RowBox[{"{", 
             RowBox[{"l", ",", "d"}], "}"}]]}], ")"}]}], "-", 
        RowBox[{"c", " ", 
         SubscriptBox["h", "i"], 
         SubscriptBox["h", "l"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sia", "*", 
             SubscriptBox["s", 
              RowBox[{"{", 
               RowBox[{"i", ",", "a"}], "}"}]]}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{"sia", "*", 
             SubscriptBox["s", 
              RowBox[{"{", 
               RowBox[{"i", ",", "d"}], "}"}]]}], ")"}]}], ")"}]}], "+", 
        RowBox[{"b", 
         SubscriptBox["h", "i"], 
         SubscriptBox["h", "l"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["s", 
            RowBox[{"{", 
             RowBox[{"l", ",", "a"}], "}"}]], "-", 
           SubscriptBox["s", 
            RowBox[{"{", 
             RowBox[{"l", ",", "d"}], "}"}]]}], ")"}]}]}], ")"}], 
      "]"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82338697884581*^9, 3.823387076141367*^9}, 
   3.823387124475095*^9, {3.823387318008675*^9, 3.823387320742793*^9}, {
   3.823387435282153*^9, 3.823387439600625*^9}, {3.823387490326923*^9, 
   3.8233875682412777`*^9}, {3.8233877054311323`*^9, 3.8233877059383507`*^9}},
 
 CellLabel->"In[9]:=",ExpressionUUID->"f108c69c-c109-49af-91e8-15aa6b745fd9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Pi]CC", "[", "i_", "]"}], ":=", 
  RowBox[{"\[Pi]general", "[", 
   RowBox[{"i", ",", "1", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Pi]CD", "[", "i_", "]"}], ":=", 
   RowBox[{"\[Pi]general", "[", 
    RowBox[{"i", ",", "1", ",", "0"}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Pi]DC", "[", "i_", "]"}], ":=", 
  RowBox[{"\[Pi]general", "[", 
   RowBox[{"i", ",", "0", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Pi]DD", "[", "i_", "]"}], ":=", 
  RowBox[{"\[Pi]general", "[", 
   RowBox[{"i", ",", "0", ",", "0"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.823386919510675*^9, {3.82338727411495*^9, 3.823387279902296*^9}, {
   3.823387476492145*^9, 3.823387481989378*^9}, {3.8233875766743717`*^9, 
   3.823387681594141*^9}, {3.82339429744945*^9, 3.823394306114963*^9}, {
   3.823438968330082*^9, 3.823438973205099*^9}, {3.8234445144705467`*^9, 
   3.82344452036104*^9}, {3.823452418085793*^9, 3.823452436956943*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"8dae6271-32d4-4c65-b111-3bd6644bd8b8"],

Cell["The strategy-specific payoffs are therefore", "Text",
 CellChangeTimes->{{3.8234525364496527`*^9, 
  3.82345254500187*^9}},ExpressionUUID->"b84a2191-ff2c-4123-be15-\
ffe21a5d49ed"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Pi]CC", "[", "i", "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Pi]CD", "[", "i", "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Pi]DC", "[", "i", "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Pi]DD", "[", "i", "]"}]}], "Input",
 CellChangeTimes->{{3.8234524687226467`*^9, 3.823452489102311*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"dc136a97-71b8-470a-9304-2967b142f232"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{"b", "-", "c"}], ")"}]}], " ", 
   SubscriptBox["s", 
    RowBox[{"{", 
     RowBox[{"i", ",", "a"}], "}"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"l", "=", "1"}], "n"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"i", ",", "a"}], "}"}]]}], "-", 
      RowBox[{"c", " ", 
       SubscriptBox["h", "i"], " ", 
       SubscriptBox["h", "l"], " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"i", ",", "a"}], "}"}]]}], "-", 
      RowBox[{"c", " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"i", ",", "d"}], "}"}]]}], "+", 
      RowBox[{"c", " ", 
       SubscriptBox["h", "i"], " ", 
       SubscriptBox["h", "l"], " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"i", ",", "d"}], "}"}]]}], "+", 
      RowBox[{"b", " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"l", ",", "a"}], "}"}]]}], "+", 
      RowBox[{"b", " ", 
       SubscriptBox["h", "i"], " ", 
       SubscriptBox["h", "l"], " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"l", ",", "a"}], "}"}]]}], "+", 
      RowBox[{"b", " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"l", ",", "d"}], "}"}]]}], "-", 
      RowBox[{"b", " ", 
       SubscriptBox["h", "i"], " ", 
       SubscriptBox["h", "l"], " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"l", ",", "d"}], "}"}]]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.823452474506207*^9, 3.823452489444985*^9}},
 CellLabel->"Out[11]=",ExpressionUUID->"6a396243-124d-48c2-a138-f2f412620433"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{"b", "-", "c"}], ")"}]}], " ", 
   SubscriptBox["s", 
    RowBox[{"{", 
     RowBox[{"i", ",", "a"}], "}"}]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"l", "=", "1"}], "n"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"i", ",", "a"}], "}"}]]}], "-", 
      RowBox[{"c", " ", 
       SubscriptBox["h", "i"], " ", 
       SubscriptBox["h", "l"], " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"i", ",", "a"}], "}"}]]}], "+", 
      RowBox[{"c", " ", 
       SubscriptBox["h", "i"], " ", 
       SubscriptBox["h", "l"], " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"i", ",", "d"}], "}"}]]}], "+", 
      RowBox[{"b", " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"l", ",", "a"}], "}"}]]}], "+", 
      RowBox[{"b", " ", 
       SubscriptBox["h", "i"], " ", 
       SubscriptBox["h", "l"], " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"l", ",", "a"}], "}"}]]}], "+", 
      RowBox[{"b", " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"l", ",", "d"}], "}"}]]}], "-", 
      RowBox[{"b", " ", 
       SubscriptBox["h", "i"], " ", 
       SubscriptBox["h", "l"], " ", 
       SubscriptBox["s", 
        RowBox[{"{", 
         RowBox[{"l", ",", "d"}], "}"}]]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.823452474506207*^9, 3.823452489937789*^9}},
 CellLabel->"Out[12]=",ExpressionUUID->"e3e24ae5-5884-4fde-8fad-c300cec6817c"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"l", "=", "1"}], "n"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c"}], " ", 
      SubscriptBox["s", 
       RowBox[{"{", 
        RowBox[{"i", ",", "d"}], "}"}]]}], "+", 
     RowBox[{"b", " ", 
      SubscriptBox["s", 
       RowBox[{"{", 
        RowBox[{"l", ",", "a"}], "}"}]]}], "+", 
     RowBox[{"b", " ", 
      SubscriptBox["h", "i"], " ", 
      SubscriptBox["h", "l"], " ", 
      SubscriptBox["s", 
       RowBox[{"{", 
        RowBox[{"l", ",", "a"}], "}"}]]}], "+", 
     RowBox[{"b", " ", 
      SubscriptBox["s", 
       RowBox[{"{", 
        RowBox[{"l", ",", "d"}], "}"}]]}], "-", 
     RowBox[{"b", " ", 
      SubscriptBox["h", "i"], " ", 
      SubscriptBox["h", "l"], " ", 
      SubscriptBox["s", 
       RowBox[{"{", 
        RowBox[{"l", ",", "d"}], "}"}]]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.823452474506207*^9, 3.823452490310362*^9}},
 CellLabel->"Out[13]=",ExpressionUUID->"c2b4f2da-dda7-4e3f-aaac-9b3fc8045f98"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{"l", "=", "1"}], "n"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"b", " ", 
      SubscriptBox["s", 
       RowBox[{"{", 
        RowBox[{"l", ",", "a"}], "}"}]]}], "+", 
     RowBox[{"b", " ", 
      SubscriptBox["h", "i"], " ", 
      SubscriptBox["h", "l"], " ", 
      SubscriptBox["s", 
       RowBox[{"{", 
        RowBox[{"l", ",", "a"}], "}"}]]}], "+", 
     RowBox[{"b", " ", 
      SubscriptBox["s", 
       RowBox[{"{", 
        RowBox[{"l", ",", "d"}], "}"}]]}], "-", 
     RowBox[{"b", " ", 
      SubscriptBox["h", "i"], " ", 
      SubscriptBox["h", "l"], " ", 
      SubscriptBox["s", 
       RowBox[{"{", 
        RowBox[{"l", ",", "d"}], "}"}]]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.823452474506207*^9, 3.823452490549097*^9}},
 CellLabel->"Out[14]=",ExpressionUUID->"b6719f96-48f3-4bb1-bd1e-42c43063b15e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"use", " ", 
    RowBox[{"(", 
     RowBox[{"1", ",", "1"}], ")"}], " ", "for", " ", "the", " ", "summand", 
    " ", "since", " ", "taking", " ", "the", " ", "average", " ", "will", " ",
     "take", " ", "care", " ", "of", " ", "strategy", " ", "frequency"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Y", "[", 
    RowBox[{"\[Pi]strat_", ",", "i_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"n", "*", 
      RowBox[{"\[Pi]strat", "[", "i", "]"}]}], "-", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"j", "=", "1"}], "n"], " ", 
      RowBox[{"\[Pi]general", "[", 
       RowBox[{"j", ",", "1", ",", "1"}], "]"}]}]}], "//", "ExpandAll", 
    " "}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8233869776157293`*^9, 3.823387709090459*^9, {3.823388134995894*^9, 
   3.823388194901888*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"60c0d90a-f750-412f-a6e3-15728b276f81"]
}, Open  ]]
},
WindowSize->{1261, 751},
WindowMargins->{{4, Automatic}, {0, Automatic}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a7b25218-fa50-471c-b008-9fdee82e451b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 254, 4, 98, "Title",ExpressionUUID->"1a4704ba-5d29-4218-886c-1ac9dab42a90"],
Cell[837, 28, 224, 3, 30, "Input",ExpressionUUID->"50828f83-f146-4bc3-9348-2b5bd8c82238"],
Cell[1064, 33, 2869, 85, 96, "Input",ExpressionUUID->"f108c69c-c109-49af-91e8-15aa6b745fd9",
 InitializationCell->True],
Cell[3936, 120, 1150, 26, 110, "Input",ExpressionUUID->"8dae6271-32d4-4c65-b111-3bd6644bd8b8",
 InitializationCell->True],
Cell[5089, 148, 186, 3, 35, "Text",ExpressionUUID->"b84a2191-ff2c-4123-be15-ffe21a5d49ed"],
Cell[CellGroupData[{
Cell[5300, 155, 392, 6, 94, "Input",ExpressionUUID->"dc136a97-71b8-470a-9304-2967b142f232"],
Cell[5695, 163, 1826, 58, 60, "Output",ExpressionUUID->"6a396243-124d-48c2-a138-f2f412620433"],
Cell[7524, 223, 1703, 54, 60, "Output",ExpressionUUID->"e3e24ae5-5884-4fde-8fad-c300cec6817c"],
Cell[9230, 279, 1088, 34, 60, "Output",ExpressionUUID->"c2b4f2da-dda7-4e3f-aaac-9b3fc8045f98"],
Cell[10321, 315, 947, 29, 60, "Output",ExpressionUUID->"b6719f96-48f3-4bb1-bd1e-42c43063b15e"]
}, Open  ]],
Cell[11283, 347, 1001, 26, 98, "Input",ExpressionUUID->"60c0d90a-f750-412f-a6e3-15728b276f81",
 InitializationCell->True]
}, Open  ]]
}
]
*)

